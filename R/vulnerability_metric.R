#library(dbplyr)

#' This function read .rds file
#'
#' @param path Path of .rds with the temperatures
#'
#' @return dataframe with the rds file or NULL
#' @export
#'
#' @examples
read_temp_file <- function(path = './data/cdd_hdd_uf_2014_2023_dashboard.rds')
{
  if(!file.exists(path))
  {
    warning("O arquivo ou pasta nao existe!")
    df <- NULL
  }else{
    df <- readRDS(path)
  }

  return(df)
}


#' This function groups states based on average temperature (vulnerability)
#'
#' @param year is a interger value
#'
#' @return The four groups of vulnerabilities
#' @export
#'
#' @examples agg_by_uf(year = 2016)
#'
agg_by_uf <- function(year = 2016)
{
  df <- read_temp_file()

  if(year %in% df$date){
    g1 <- df %>% filter(date == year) %>% filter(t_mean_annual >= 17.6 & t_mean_annual <= 20.4)

    g2 <- df %>% filter(date == year) %>% filter(t_mean_annual >= 20.5 & t_mean_annual <= 23.3)

    g3 <- df %>% filter(date == year) %>% filter(t_mean_annual >= 23.4 & t_mean_annual <= 26.3)

    g4 <- df %>% filter(date == year) %>% filter(t_mean_annual >= 26.4 & t_mean_annual <= 29.2)

  }else{
    warning("Este ano nao existe.")
    g1 <- NULL
    g2 <- NULL
    g3 <- NULL
    g4 <- NULL
  }
  return(list(g1, g2, g3, g4))
}

