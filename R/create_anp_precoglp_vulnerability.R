#' Creates ANP - PRECOGLP Vulnerability
#'
#' This function read the data from ANP - Preço do GLP
#' wider data version and summarizes all vulnerabilities
#' at UF, region, and country view per stats.
#'
#' @param anp_precoglp_wider ANP - Preço do GLP dataset transformed in wider data version
#'
#' @returns A dataframe
#' @export
#'
#' @examples
#' \dontrun{
#'   anp_preco_glp_wider <- anp_precoglp_transform_wider()
#'   anp_precoglp_summarized_by_vulnerability <- create_anp_precoglp_vulnerability(anp_precoglp_wider)
#' }
create_anp_precoglp_vulnerability <- function(anp_precoglp_wider){

  anp_precoglp_summarized_by_vulnerability <- anp_precoglp_wider |>

    tidyr::pivot_longer(
      cols = valor_de_venda_AVG,
      names_to = "variable_id",
      values_to = "stats_value"
    ) |>

    dplyr::mutate(
      stats_name = sub(".*_", "", variable_id),
      variable_id = sub("_(?!.*_).*", "", variable_id, perl = TRUE)
    ) |>

    dplyr::relocate( stats_name, .before = stats_value)

  return (anp_precoglp_summarized_by_vulnerability)
}
